<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <title>Registro de Estadísticas CODISEC</title>
  </head>
  <body class="bg-gray-100">
    <div
      id="login-container"
      class="flex items-center justify-center h-screen bg-gray-200"
      style="display: none"
    >
      <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md">
        <div class="text-center">
          <h2 class="text-3xl font-bold text-gray-800">Iniciar Sesión</h2>
          <p class="mt-2 text-gray-500">
            Acceso al panel de Estadísticas CODISEC
          </p>
        </div>

        <form id="login-form" class="space-y-6">
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700"
              >Correo Electrónico</label
            >
            <input
              id="email"
              name="email"
              type="email"
              autocomplete="email"
              required
              class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
            />
          </div>

          <div>
            <label
              for="password"
              class="block text-sm font-medium text-gray-700"
              >Contraseña</label
            >
            <input
              id="password"
              name="password"
              type="password"
              autocomplete="current-password"
              required
              class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
            />
          </div>

          <div id="login-error" class="text-sm text-red-600"></div>

          <div>
            <button
              type="submit"
              class="w-full px-4 py-2 font-medium text-white bg-sky-600 rounded-md hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500"
            >
              Ingresar
            </button>
          </div>
        </form>

        <div class="relative">
          <div class="absolute inset-0 flex items-center">
            <div class="w-full border-t border-gray-300"></div>
          </div>
          <div class="relative flex justify-center text-sm">
            <span class="px-2 bg-white text-gray-500">O continuar con</span>
          </div>
        </div>

        <div>
          <button
            id="google-signin-button"
            class="w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"
          >
            <svg
              class="w-5 h-5 mr-2"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 48 48"
              width="48px"
              height="48px"
            >
              <path
                fill="#FFC107"
                d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"
              ></path>
              <path
                fill="#FF3D00"
                d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"
              ></path>
              <path
                fill="#4CAF50"
                d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.223,0-9.651-3.358-11.297-7.962l-6.571,4.819C9.656,39.663,16.318,44,24,44z"
              ></path>
              <path
                fill="#1976D2"
                d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C42.021,35.596,44,30.138,44,24C44,22.659,43.862,21.35,43.611,20.083z"
              ></path>
            </svg>
            Google
          </button>
        </div>
      </div>
    </div>

    <div id="app-container" class="h-screen" style="display: none">
      <div class="flex h-full">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-md flex-shrink-0">
          <div class="p-4 border-b">
            <h1 class="text-xl font-bold text-gray-800">Estadísticas</h1>
            <p class="text-sm text-gray-500">CODISEC Chorrillos</p>
          </div>
          <nav id="sidebar-nav" class="p-4 space-y-2">
            <a class="sidebar-link active" data-view="estadisticas-generales">
              <i data-lucide="layout-list" class="w-5 h-5 mr-3"></i>
              <span>Estadísticas Generales</span>
            </a>
            <a class="sidebar-link" data-view="ocurrencias-sipcop">
              <i data-lucide="siren" class="w-5 h-5 mr-3"></i>
              <span>Ocurrencias SIPCOP</span>
            </a>
            <a class="sidebar-link" data-view="delitos-comisaria">
              <i data-lucide="shield" class="w-5 h-5 mr-3"></i>
              <span>Delitos por Comisaría</span>
            </a>
            <a class="sidebar-link" data-view="observatorio-delito">
              <i data-lucide="bar-chart-3" class="w-5 h-5 mr-3"></i>
              <span>Observatorio del Delito</span>
            </a>
            <a class="sidebar-link" data-view="operativos-patrullaje">
              <i data-lucide="car-front" class="w-5 h-5 mr-3"></i>
              <span>Operativos y Patrullaje</span>
            </a>
            <a class="sidebar-link" data-view="frustracion-robos">
              <i data-lucide="hand" class="w-5 h-5 mr-3"></i>
              <span>Frustración de Robos</span>
            </a>
            <a class="sidebar-link" data-view="personal">
              <i data-lucide="users" class="w-5 h-5 mr-3"></i>
              <span>Personal</span>
            </a>
            <a class="sidebar-link" data-view="vehiculos">
              <i data-lucide="bike" class="w-5 h-5 mr-3"></i>
              <span>Vehículos (Motos)</span>
            </a>
            <a class="sidebar-link" data-view="reports">
              <i data-lucide="pie-chart" class="w-5 h-5 mr-3"></i>
              <span>Reportes y Gráficos</span>
            </a>
            <a class="sidebar-link" data-view="bulk-upload">
              <i data-lucide="upload-cloud" class="w-5 h-5 mr-3"></i>
              <span>Carga Masiva</span>
            </a>
            <a class="sidebar-link" data-view="export">
              <i data-lucide="download-cloud" class="w-5 h-5 mr-3"></i>
              <span>Exportar Datos</span>
            </a>
          </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto">
          <header class="sticky top-0 bg-white shadow-sm p-4 z-10">
            <div class="flex justify-between items-center">
              <div>
                <h2
                  id="view-title"
                  class="text-2xl font-semibold text-gray-700"
                >
                  Estadísticas Generales
                </h2>
              </div>
              <div class="flex items-center space-x-4">
                <select
                  id="year-select"
                  class="p-2 border rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
                ></select>
                <select
                  id="month-select"
                  class="p-2 border rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
                >
                  <option value="1">Enero</option>
                  <option value="2">Febrero</option>
                  <option value="3">Marzo</option>
                  <option value="4">Abril</option>
                  <option value="5">Mayo</option>
                  <option value="6">Junio</option>
                  <option value="7">Julio</option>
                  <option value="8">Agosto</option>
                  <option value="9">Septiembre</option>
                  <option value="10">Octubre</option>
                  <option value="11">Noviembre</option>
                  <option value="12">Diciembre</option>
                </select>
                <button
                  id="save-button"
                  class="bg-sky-600 text-white px-4 py-2 rounded-md hover:bg-sky-700 transition flex items-center"
                >
                  <i data-lucide="save" class="w-4 h-4 mr-2"></i>
                  <span id="save-button-text">Guardar Cambios</span>
                </button>
                <button
                  id="logout-button"
                  class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition flex items-center"
                >
                  <i data-lucide="log-out" class="w-4 h-4 mr-2"></i>
                  <span>Cerrar Sesión</span>
                </button>
              </div>
            </div>
          </header>

          <div id="content" class="p-6">
            <!-- Loading Indicator -->
            <div id="loading" class="flex justify-center items-center h-64">
              <div
                class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-sky-500"
              ></div>
            </div>

            <!-- Data Sections -->
            <div id="estadisticas-generales" class="data-section active">
              <!-- AI Summary Card -->
              <div id="ai-summary-card" class="bg-white p-6 rounded-lg shadow-md mb-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Análisis de Tendencias con IA
                </h3>
                <div class="mb-4">
                  <button id="generate-summary-estadisticasgenerales-btn" class="bg-sky-600 text-white px-4 py-2 rounded-md hover:bg-sky-700 transition flex items-center">
                    <i data-lucide="brain-circuit" class="w-4 h-4 mr-2"></i>
                    <span>Analizar y Generar Resumen</span>
                  </button>
                </div>
                <div id="summary-container-estadisticasgenerales" class="text-gray-700 space-y-2">
                  <!-- AI summary will be loaded here -->
                </div>
              </div>

              <div id="accordion-container">
                <p class="text-gray-500">Cargando datos del formulario...</p>
              </div>
            </div>

            <div id="ocurrencias-sipcop" class="data-section">
              <!-- AI Summary Card -->
              <div id="ai-summary-card-sipcop" class="bg-white p-6 rounded-lg shadow-md mb-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Análisis de Tendencias con IA (SIPCOP)
                </h3>
                <div class="mb-4">
                  <button id="generate-summary-ocurrenciassipcop-btn" class="bg-sky-600 text-white px-4 py-2 rounded-md hover:bg-sky-700 transition flex items-center">
                    <i data-lucide="brain-circuit" class="w-4 h-4 mr-2"></i>
                    <span>Analizar y Generar Resumen</span>
                  </button>
                </div>
                <div id="summary-container-ocurrenciassipcop" class="text-gray-700 space-y-2">
                  <!-- AI summary will be loaded here -->
                </div>
              </div>
              <div id="accordion-container-sipcop">
                <p class="text-gray-500">Cargando datos del formulario...</p>
              </div>
            </div>

            <div id="delitos-comisaria" class="data-section">
              <!-- AI Summary Card -->
              <div id="ai-summary-card-delitos" class="bg-white p-6 rounded-lg shadow-md mb-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Análisis de Tendencias con IA (Delitos)
                </h3>
                <div class="mb-4">
                  <button id="generate-summary-delitoscomisaria-btn" class="bg-sky-600 text-white px-4 py-2 rounded-md hover:bg-sky-700 transition flex items-center">
                    <i data-lucide="brain-circuit" class="w-4 h-4 mr-2"></i>
                    <span>Analizar y Generar Resumen</span>
                  </button>
                </div>
                <div id="summary-container-delitoscomisaria" class="text-gray-700 space-y-2">
                  <!-- AI summary will be loaded here -->
                </div>
              </div>
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"
                  id="form-delitos-comisaria"
                ></div>
              </div>
            </div>

            <div id="observatorio-delito" class="data-section">
              <!-- AI Summary Card -->
              <div id="ai-summary-card-observatorio" class="bg-white p-6 rounded-lg shadow-md mb-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Análisis de Tendencias con IA (Observatorio)
                </h3>
                <div class="mb-4">
                  <button id="generate-summary-observatoriodelito-btn" class="bg-sky-600 text-white px-4 py-2 rounded-md hover:bg-sky-700 transition flex items-center">
                    <i data-lucide="brain-circuit" class="w-4 h-4 mr-2"></i>
                    <span>Analizar y Generar Resumen</span>
                  </button>
                </div>
                <div id="summary-container-observatoriodelito" class="text-gray-700 space-y-2">
                  <!-- AI summary will be loaded here -->
                </div>
              </div>
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                  id="form-observatorio-delito"
                ></div>
              </div>
            </div>

            <div id="operativos-patrullaje" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                  id="form-operativos-patrullaje"
                ></div>
              </div>
            </div>
            <div id="frustracion-robos" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                  id="form-frustracion-robos"
                ></div>
              </div>
            </div>

            <div id="personal" class="data-section">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md">
                  <h3 class="text-lg font-semibold mb-4 text-gray-700">
                    Personal Serenazgo
                  </h3>
                  <div
                    class="grid grid-cols-1 sm:grid-cols-2 gap-4"
                    id="form-personal-serenazgo"
                  ></div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                  <h3 class="text-lg font-semibold mb-4 text-gray-700">
                    Personal CECOP
                  </h3>
                  <div
                    class="grid grid-cols-1 sm:grid-cols-2 gap-4"
                    id="form-personal-cecop"
                  ></div>
                </div>
              </div>
            </div>

            <div id="vehiculos" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">
                  Estado de Motos
                </h3>
                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                  id="form-vehiculos"
                ></div>
              </div>
            </div>

            <div id="reports" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md mb-6">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Gráfico Anual por Categoría
                </h3>
                <div class="mb-4">
                  <label
                    for="chart-category-select"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Seleccionar categoría para visualizar:</label
                  >
                  <select
                    id="chart-category-select"
                    class="w-full md:w-1/2 p-2 border rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
                  ></select>
                </div>
                <div>
                  <canvas id="monthly-chart"></canvas>
                </div>
              </div>
              <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">
                  Tabla de Totales Anuales
                </h3>
                <div class="overflow-x-auto">
                  <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                      <tr>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Categoría Principal
                        </th>
                        <th
                          scope="col"
                          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >
                          Total Anual
                        </th>
                      </tr>
                    </thead>
                    <tbody
                      id="annual-totals-table"
                      class="bg-white divide-y divide-gray-200"
                    ></tbody>
                  </table>
                </div>
              </div>
            </div>

            <div id="bulk-upload" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="max-w-4xl mx-auto">
                  <h3 class="text-2xl font-semibold mb-2 text-gray-800">
                    Carga Masiva de Datos desde CSV
                  </h3>
                  <p class="text-gray-600 mb-6">
                    Sube tus archivos CSV para cada categoría. El sistema
                    procesará los datos para el año seleccionado y los guardará
                    en la base de datos.
                  </p>

                  <div id="upload-form" class="space-y-4">
                    <!-- File inputs will be generated here -->
                  </div>

                  <div class="mt-8 pt-4 border-t">
                    <button
                      id="process-upload-btn"
                      class="w-full bg-sky-600 text-white px-6 py-3 rounded-md hover:bg-sky-700 transition flex items-center justify-center text-lg"
                    >
                      <i data-lucide="upload" class="w-5 h-5 mr-3"></i>
                      <span>Procesar y Guardar Archivos</span>
                    </button>
                  </div>
                  <div id="upload-status" class="mt-4 text-center"></div>
                </div>
              </div>
            </div>

            <div id="export" class="data-section">
              <div class="bg-white p-6 rounded-lg shadow-md">
                <div class="max-w-4xl mx-auto">
                  <h3 class="text-2xl font-semibold mb-2 text-gray-800">
                    Exportar Datos a Excel (.csv)
                  </h3>
                  <p class="text-gray-600 mb-6">
                    Selecciona los filtros para generar tu reporte. Puedes
                    exportar una sección completa o filtrar por categorías
                    específicas.
                  </p>

                  <div class="space-y-4 p-4 border rounded-md">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div>
                        <label
                          for="export-section-select"
                          class="block text-sm font-medium text-gray-700 mb-1"
                          >1. Sección Principal</label
                        >
                        <select
                          id="export-section-select"
                          class="w-full p-2 border rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
                        ></select>
                      </div>
                      <div>
                        <label
                          for="export-category-select"
                          class="block text-sm font-medium text-gray-700 mb-1"
                          >2. Categoría (Opcional)</label
                        >
                        <select
                          id="export-category-select"
                          class="w-full p-2 border rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500"
                        >
                          <option value="all">Exportar toda la sección</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="mt-8 pt-4 border-t">
                    <button
                      id="export-btn"
                      class="w-full bg-emerald-600 text-white px-6 py-3 rounded-md hover:bg-emerald-700 transition flex items-center justify-center text-lg"
                    >
                      <i
                        data-lucide="file-spreadsheet"
                        class="w-5 h-5 mr-3"
                      ></i>
                      <span>Exportar a Excel (.csv)</span>
                    </button>
                  </div>
                  <div id="export-status" class="mt-4 text-center"></div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>